use super::*;
use crate::*;

#[test]
fn fill_empty() {
    const FILL_RECT: Rect = rect(0, 0, 0, 0);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(grid.chunk_coords, []);
    assert_eq!(grid.chunks, []);
}

#[test]
fn fill_whole_chunk() {
    const FILL_RECT: Rect = rect(0, 0, CHUNK_SIZE as i32, CHUNK_SIZE as i32);
    const CHUNK: Chunk = chunk(&[
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"################################################################",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(grid.chunk_coords, [ChunkCoords { x: 0, y: 0 }]);
    assert_eq!(grid.chunks, [CHUNK]);
}

#[test]
fn fill_singel_cell() {
    const FILL_RECT: Rect = rect(2, 2, 3, 3);
    const CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"..#.............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(grid.chunk_coords, [ChunkCoords { x: 0, y: 0 }]);
    assert_eq!(grid.chunks, [CHUNK]);
}

#[test]
fn fill_chunk_row() {
    const FILL_RECT: Rect = rect(0, 4, CHUNK_SIZE as i32, 5);
    const CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"################################################################",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(grid.chunk_coords, [ChunkCoords { x: 0, y: 0 }]);
    assert_eq!(grid.chunks, [CHUNK]);
}

#[test]
fn fill_chunk_column() {
    const FILL_RECT: Rect = rect(6, 0, 7, CHUNK_SIZE as i32);
    const CHUNK: Chunk = chunk(&[
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
        b"......#.........................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(grid.chunk_coords, [ChunkCoords { x: 0, y: 0 }]);
    assert_eq!(grid.chunks, [CHUNK]);
}

#[test]
fn fill_cross_horizontal() {
    const FILL_RECT: Rect = rect(60, 3, 68, 6);
    const LEFT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);
    const RIGHT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(
        grid.chunk_coords,
        [ChunkCoords { x: 0, y: 0 }, ChunkCoords { x: 1, y: 0 }],
    );
    assert_eq!(grid.chunks, [LEFT_CHUNK, RIGHT_CHUNK]);
}

#[test]
fn fill_wide_cross_horizontal() {
    const FILL_RECT: Rect = rect(-4, 3, 68, 6);
    const LEFT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);
    const MIDDLE_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"################################################################",
        b"################################################################",
        b"################################################################",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);
    const RIGHT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(
        grid.chunk_coords,
        [
            ChunkCoords { x: -1, y: 0 },
            ChunkCoords { x: 0, y: 0 },
            ChunkCoords { x: 1, y: 0 },
        ],
    );
    assert_eq!(grid.chunks, [LEFT_CHUNK, MIDDLE_CHUNK, RIGHT_CHUNK]);
}

#[test]
fn fill_cross_vertical() {
    const FILL_RECT: Rect = rect(2, 60, 4, 68);
    const TOP_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
    ]);
    const BOTTOM_CHUNK: Chunk = chunk(&[
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(
        grid.chunk_coords,
        [ChunkCoords { x: 0, y: 0 }, ChunkCoords { x: 0, y: 1 }],
    );
    assert_eq!(grid.chunks, [TOP_CHUNK, BOTTOM_CHUNK]);
}

#[test]
fn fill_wide_cross_vertical() {
    const FILL_RECT: Rect = rect(2, -4, 4, 68);
    const TOP_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
    ]);
    const MIDDLE_CHUNK: Chunk = chunk(&[
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
    ]);
    const BOTTOM_CHUNK: Chunk = chunk(&[
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"..##............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(
        grid.chunk_coords,
        [
            ChunkCoords { x: 0, y: -1 },
            ChunkCoords { x: 0, y: 0 },
            ChunkCoords { x: 0, y: 1 },
        ],
    );
    assert_eq!(grid.chunks, [TOP_CHUNK, MIDDLE_CHUNK, BOTTOM_CHUNK]);
}

#[test]
fn fill_cross_quad() {
    const FILL_RECT: Rect = rect(60, 60, 68, 68);
    const TOP_LEFT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
    ]);
    const BOTTOM_LEFT_CHUNK: Chunk = chunk(&[
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
        b"............................................................####",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);
    const TOP_RIGHT_CHUNK: Chunk = chunk(&[
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
    ]);
    const BOTTOM_RIGHT_CHUNK: Chunk = chunk(&[
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
        b"####............................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
        b"................................................................",
    ]);

    let mut grid = Grid::new();
    grid.fill(FILL_RECT);
    assert_eq!(
        grid.chunk_coords,
        [
            ChunkCoords { x: 0, y: 0 },
            ChunkCoords { x: 1, y: 0 },
            ChunkCoords { x: 0, y: 1 },
            ChunkCoords { x: 1, y: 1 },
        ],
    );
    assert_eq!(
        grid.chunks,
        [
            TOP_LEFT_CHUNK,
            TOP_RIGHT_CHUNK,
            BOTTOM_LEFT_CHUNK,
            BOTTOM_RIGHT_CHUNK,
        ],
    );
}
